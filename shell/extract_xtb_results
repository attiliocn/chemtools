#!/bin/bash

if test -e extracted_results; then
    echo 'WARNING: Impossible to extract the results. The results_extracted folder already exists!'
    exit
else
    mkdir results_extracted
fi

for i in $(ls -d */); do
    i=${i/\//}
   
    if test -f "$i"/xtbopt.log; then
        cp "$i"/xtbopt.xyz results_extracted/"$i".xyz
    elif test -f "$i"/crest_clustered.xyz; then
        echo "Found CREGEN clustered ensemble!"
        cp "$i"/crest_clustered.xyz results_extracted/"$i"_confs.xyz
    elif test -f "$i"/crest_conformers.xyz; then
        cp "$i"/crest_conformers.xyz results_extracted/"$i"_confs.xyz
    fi  
done

echo 'Done!'
